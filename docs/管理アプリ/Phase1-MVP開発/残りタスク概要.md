# タスク概要: 残りのタスク (簡易版)

このドキュメントは、詳細タスクドキュメントが未作成のタスクの概要をまとめたものです。各タスクの詳細は、実装前に作成してください。

## 04. 認証認可サービス - ロール管理

**概要**: ユーザーへのロール割り当てとサービス横断的なロール情報統合機能を実装

**主な実装内容**:
- RoleAssignment エンティティ管理
- POST /api/v1/users/{userId}/roles (ロール割り当て)
- DELETE /api/v1/users/{userId}/roles/{roleId} (ロール削除)
- GET /api/v1/roles (利用可能ロール一覧)
- サービス設定サービスからロール情報取得
- ロール階層の実装

**見積もり**: 2.5日

---

## 05. テナント管理サービス - コアAPI

**概要**: テナントCRUD操作と特権テナント保護機能を実装

**主な実装内容**:
- Tenant エンティティ管理
- GET /api/v1/tenants (テナント一覧)
- POST /api/v1/tenants (テナント作成)
- PUT /api/v1/tenants/{tenantId} (テナント更新)
- DELETE /api/v1/tenants/{tenantId} (テナント削除)
- 特権テナントの編集・削除禁止ロジック
- テナントステータス管理

**見積もり**: 3日

---

## 06. テナント管理サービス - ユーザー・ドメイン管理

**概要**: テナントユーザー管理とドメイン検証機能を実装

**主な実装内容**:
- TenantUser, Domain エンティティ管理
- POST /api/v1/tenants/{tenantId}/users (ユーザー追加)
- DELETE /api/v1/tenants/{tenantId}/users/{userId} (ユーザー削除)
- POST /api/v1/tenants/{tenantId}/domains (ドメイン追加)
- POST /api/v1/tenants/{tenantId}/domains/{domainId}/verify (ドメイン検証)
- DNS検証ロジック

**見積もり**: 2.5日

---

## 07. サービス設定サービス - コアAPI

**概要**: サービスカタログとサービス割り当て機能を実装

**主な実装内容**:
- Service, ServiceAssignment エンティティ管理
- GET /api/v1/services (サービスカタログ)
- POST /api/v1/tenants/{tenantId}/services (サービス割り当て)
- DELETE /api/v1/tenants/{tenantId}/services/{serviceId}
- サービス利用状況管理
- テナント別クォータ管理

**見積もり**: 3日

---

## 08. サービス設定サービス - ロール統合

**概要**: 各サービスからロール情報を収集し、統合APIを提供

**主な実装内容**:
- GET /api/v1/tenants/{tenantId}/available-roles
- GET /api/v1/services/{serviceId}/roles
- 各サービスの /roles エンドポイント呼び出し
- ロール情報キャッシング（Phase 2）
- 非同期並列取得

**見積もり**: 2日

---

## 10. ファイル管理サービス

**概要**: ファイルアップロード・ダウンロード・管理機能を実装

**主な実装内容**:
- File, Folder エンティティ管理
- POST /api/v1/files (ファイルアップロード)
- GET /api/v1/files/{fileId} (ファイルダウンロード)
- DELETE /api/v1/files/{fileId}
- POST /api/v1/folders (フォルダ作成)
- ロール情報提供API実装
- ファイルサイズ制限

**見積もり**: 3日

---

## 11. メッセージングサービス

**概要**: チャネル管理とメッセージ送受信機能を実装

**主な実装内容**:
- Channel, Message, ChannelMember エンティティ管理
- POST /api/v1/channels (チャネル作成)
- POST /api/v1/channels/{channelId}/messages (メッセージ送信)
- GET /api/v1/channels/{channelId}/messages (メッセージ一覧)
- POST /api/v1/channels/{channelId}/members (メンバー追加)
- ロール情報提供API実装

**見積もり**: 3日

---

## 12. API利用サービス

**概要**: APIキー管理と利用状況追跡機能を実装

**主な実装内容**:
- APIKey, APIUsage, APIUsageAggregate エンティティ管理
- POST /api/v1/api-keys (APIキー発行)
- GET /api/v1/api-keys (APIキー一覧)
- GET /api/v1/usage (利用統計)
- APIキーのハッシュ保存
- レート制限機能
- TTL設定（90日）

**見積もり**: 2.5日

---

## 13. バックアップサービス

**概要**: バックアップジョブ管理とバックアップ履歴追跡機能を実装

**主な実装内容**:
- BackupJob, BackupHistory エンティティ管理
- POST /api/v1/backup-jobs (バックアップジョブ作成)
- POST /api/v1/backup-jobs/{jobId}/execute (バックアップ実行)
- GET /api/v1/backup-history (履歴一覧)
- Cronスケジュール設定
- ロール情報提供API実装

**見積もり**: 2.5日

---

## 15. Frontend - 認証画面

**概要**: ログイン・ログアウト画面の実装

**主な実装内容**:
- app/(auth)/login/page.tsx
- LoginForm コンポーネント
- useAuth フック活用
- バリデーション（Zod + React Hook Form）
- エラーハンドリング
- ローディング状態表示

**見積もり**: 1.5日

---

## 16. Frontend - テナント管理画面

**概要**: テナント一覧・詳細・編集画面の実装

**主な実装内容**:
- app/(dashboard)/tenants/page.tsx (一覧)
- app/(dashboard)/tenants/[id]/page.tsx (詳細)
- TenantList, TenantDetail, TenantForm コンポーネント
- GET /api/tenants
- POST /api/tenants
- PUT /api/tenants/{id}
- 特権テナント編集制限のUI実装

**見積もり**: 3日

---

## 17. Frontend - ユーザー管理画面

**概要**: ユーザー一覧・詳細・ロール管理画面の実装

**主な実装内容**:
- app/(dashboard)/users/page.tsx (一覧)
- app/(dashboard)/users/[id]/page.tsx (詳細)
- UserList, UserDetail, UserForm, RoleAssignment コンポーネント
- GET /api/users
- POST /api/users
- POST /api/users/{id}/roles
- ロール選択UI（利用可能サービスに応じて動的表示）

**見積もり**: 3日

---

## 18. Frontend - サービス設定画面

**概要**: サービス割り当て画面の実装

**主な実装内容**:
- app/(dashboard)/services/page.tsx
- ServiceCatalog, ServiceAssignment コンポーネント
- GET /api/services
- POST /api/tenants/{id}/services
- ドラッグ&ドロップUI (Phase 2)

**見積もり**: 2日

---

## 19. Frontend - ダッシュボード

**概要**: 統計情報表示とダッシュボード画面の実装

**主な実装内容**:
- app/(dashboard)/page.tsx
- Dashboard, StatCard, Chart コンポーネント
- GET /api/dashboard (集約API)
- テナント数、ユーザー数、サービス利用状況の表示
- グラフ表示 (recharts)

**見積もり**: 2.5日

---

## 22. デプロイメント設定

**概要**: Azure App Serviceの詳細設定と環境変数管理

**主な実装内容**:
- App Service環境変数設定
- CORS設定
- カスタムドメイン設定（Phase 2）
- SSL証明書設定（Phase 2）
- アプリケーション設定の文書化
- デプロイメントチェックリスト

**見積もり**: 1.5日

---

## 23. モニタリング・ロギング設定

**概要**: Application Insightsの詳細設定とアラート構成

**主な実装内容**:
- Application Insightsダッシュボード作成
- カスタムメトリクス設定
- アラートルール設定（レスポンスタイム、エラー率等）
- ログクエリの作成（Kusto）
- アラート通知先設定（Slack, Email）
- 運用ドキュメント作成

**見積もり**: 2日

---

## 24. セキュリティ強化

**概要**: セキュリティ機能の追加と強化

**主な実装内容**:
- レート制限の実装（SlowAPI）
- CORSヘッダーの設定
- セキュリティヘッダーの追加（HSTS, CSP等）
- 入力検証の強化
- SQLインジェクション対策確認
- XSS対策確認
- CSRF対策確認（Cookie設定）
- セキュリティスキャン実行
- 脆弱性対応

**見積もり**: 2日

---

## 注意事項

これらのタスクは概要のみを記載したものです。実装前に以下を行ってください：

1. **詳細タスクドキュメントの作成**
   - 各タスクについて、01-03, 09, 14, 20, 21, 25と同様の詳細ドキュメントを作成

2. **仕様の確認**
   - アーキテクチャドキュメントを参照
   - API設計、データモデル設計を確認

3. **依存関係の確認**
   - 前提タスクが完了していることを確認
   - 必要なリソースが利用可能であることを確認

4. **見積もりの調整**
   - チームの経験値に応じて工数を調整
   - バッファを考慮

## タスク実施順序

推奨される実施順序：
1. 04 → 05 → 06 (認証認可とテナント管理の基盤)
2. 07 → 08 (サービス設定の基盤)
3. 10, 11, 12, 13 並行実施可能（モックサービス）
4. 15 → 16 → 17 → 18 → 19 (Frontend、順次実施)
5. 22 → 23 → 24 (デプロイ後の設定と強化)
