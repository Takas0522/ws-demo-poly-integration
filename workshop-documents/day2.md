# GitHub Copilotを使用したポリレポ構造アプリの開発

GitHub Copilotを使用してコードとドキュメントから下記の作業を実施します。

0. 事前準備
1. 開発チケットの作成

## 0. 事前準備

このリポジトリをCloneするかForkします。
Dockerが使用できる場合はDevContainerでコードを開き、Codespacesが使用できる場合はそこからコードを参照してみましょう。
`day2` ブランチに切り替えて実施します。

## 1. 開発チケットの作成

作成された文章をベースに開発チケットを作成し登録します。

```markdown
`docs/PoCアプリ/Specs/{追加機能名}`に格納された機能情報をベースに開発計画を作成します。
下記の方針で開発計画を作成し、`docs/PoCアプリ/Specs/{追加機能名}/開発タスク`に開発タスクを作成してください。

- 開発タスクは統括する親Issueとそれの紐づく細かい作業のSub-Issueの構成で作成されます
- 開発タスク同士の依存関係や同時実行可能なタスクが存在する場合はそれを明記します
- 開発タスクの順番が明確にわかるようにタイトルに順番が記載されます
- 開発タスクごとにファイルが作成されます
- 開発タスクは開発者が開発しやすい粒度で構成されます
- 開発タスクのサマリレポートを作成します。並行実行可能、クリティカルパスなどの開発タスクを進めるうえでの参考情報が記載されいます
- 内部で記載される情報として図示したほうが適切な場合はMermaid記法で記述されます
```

Coding Agentを使用したい場合は `gh` コマンドを使用し作成された開発チケットをもとにIssueを作成します。
GitHub Copilotに下記のように依頼すれば作成してくれます。

```markdown
`docs/PoCアプリ/Specs/{追加機能名}/開発タスク`に記載された内容をもとに`gh`コマンドを使用してGitHub Issueを作成してください。
```

## 2. 開発計画をもとにCoding AgentまたはAgentモードを使用して開発を実施する

作成された開発計画の一つをターゲットに実装を行います。
Agentモード、またはCoding Agentを利用します。

```markdown
`docs/{アプリ名}/{開発プラン名}/{開発順序}-{タスク名}.md`に記載された内容をもとに開発を行ってください。
```

## 3.Custom Agentを用いた開発の実施

単一の機能に特化したカスタムエージェントを構築して作業を実施してみます。
まずは下記プロンプトでカスタムエージェントを構築してみます。

```markdown
単体テストを実装することに特化したカスタムエージェントを構築します。
下記のように動作します。

- 実装された機能をもとに単体テストの計画を構築し実装を行います
  - バックエンドはPyTest、フロントエンドはJestを使用してテストが構成されます
- 構築するのはテストなので実際に動作するアプリ側の実装を編集することは厳禁です
- テストは各サービスで展開されているリポジトリ内で実装される必要があります
- テスト実行後はテストレポートを作成し `docs/{アプリ名}/{開発プラン名}/{テスト日時}-単体テストレポート.md`として格納します
<!-- 以下好きに構成 -->
- テストはISTQBで定義されているテスト要求に従います
- テストの実装後はテストを実施し失敗がなくなるまで実装を繰り返します

カスタムエージェントの構築は下記のプラクティスなどを参考に日本語で構築してください

- https://docs.github.com/en/copilot/concepts/agents/coding-agent/about-custom-agents?utm_source=changelog-docs-custom-agents&utm_medium=changelog&utm_campaign=universe25
- https://github.blog/ai-and-ml/github-copilot/how-to-write-a-great-agents-md-lessons-from-over-2500-repositories/
```

作成されたカスタムエージェントを利用しテストの実装を行います。
Agentモードを作成したカスタムエージェントに変更し下記プロンプトを実行します。

```markdown
フロントエンドのテストを構築してください
```

## 4. SubAgentを用いたレビューを含む一気通貫の開発の実施

一度作成されたものを削除し、開発計画の作成～単体テストの実装まで一気通貫して開発を実施するためのエージェントを構築してみます。
エージェントは各工程の作業を実施するサブエージェントとそれを統括するオーケストレータエージェントの構成となります。
まずはカスタムエージェントを構築します。

```markdown
開発タスクの作成から単体テストの構築まで一気通貫で実施するカスタムエージェントを構築します。
エージェントは下記の手順で作業を実施します。

1. 開発タスクを作成します
   - 提示された情報源やプロンプトの情報をもとに開発タスクを構築します
   - 開発タスクはそれぞれ完了条件が存在しエージェントの作業内で確認可能な粒度で作成されます
     - 各タスク: `docs/{アプリ名}/{開発プラン名}/{開発順序}-{タスク名}.md`
   - 開発タスクの進捗を管理するための開発タスクリストが作成されます。このエージェントで作業される単位で開発タスクリストは作成されます。
     - 進捗管理: `docs/{アプリ名}/{開発プラン名}/開発タスク.md`
2. 開発の実装を行います。開発タスクで構成された各作業が下記の手順で実施されます。実装のビルドと単体テストがパスするまで繰り返されます。各工程の終了時に開発タスクを更新します。
   1. 開発タスクに記載された開発の実装
   2. 構築された実装のレビューと修復
   3. 単体テストの計画
   4. 構築された計画のレビューと修復
3. 統合とレポートの提出
   - アプリケーション全体を確認し整合性が取れていないところがないか確認を行います
   - 全体のテストとビルドを実行しエラーが発生している場合は修復します
   - 結果のレポートを`docs/{アプリ名}/{開発プラン名}/作業結果.md` に格納します。

カスタムエージェントとサブエージェントは下記のサイトを参考に構築を行います。
https://code.visualstudio.com/docs/copilot/agents/subagents
```

作成されたサブエージェントを利用して開発を行います。Agentモードから構築したオーケストレーションエージェントに変更を行い開発を行ってもらいましょう。
この実装フェーズはおそらく時間内に終わりません。

```markdown
`docs/{アプリ名}/{開発プラン名}`の機能を実装してください。
```
